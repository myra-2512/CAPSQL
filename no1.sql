CREATE TABLE IF NOT EXISTS SALESMAN(
    SALESMAN_ID TEXT PRIMARY KEY,
    NAME TEXT,
    CITY TEXT,
    COMMISION TEXT
);

INSERT INTO SALESMAN (SALESMAN_ID, NAME, CITY, COMMISION) VALUES
('5001', 'James Hoog', 'New York', '0.15'),
('5002', 'Jane Smith', 'Los Angeles', '0.13'),
('5003', 'Jim Brown', 'Chicago', '0.11'),
('5004', 'Jake White', 'Houston', '0.14'),
('5005', 'Jill Green', 'Phoenix', '0.13'),
('5006', 'Joe Black', 'Philadelphia', '0.12');

CREATE TABLE IF NOT EXISTS CUSTOMER(
    CUST_ID TEXT,
    CUST_NAME TEXT PRIMARY KEY,
    CITY TEXT,
    GRADE TEXT,
    SALESMAN_ID TEXT
);

INSERT INTO CUSTOMER (CUST_ID, cust_name, CITY, GRADE, SALESMAN_ID) VALUES
('3002', 'Alpha Corp', 'New York', '2', '5001'),
('3007', 'Beta LLC', 'Los Angeles', '3', '5001'),
('3005', 'Gamma Inc', 'Chicago', '1', '5002'),
('3008', 'Delta Co', 'Houston', '2', '5002'),
('3001', 'Epsilon Ltd', 'Phoenix', '3', '5006'),
('3004', 'Zeta Enterprises', 'Philadelphia', '1', '5003'),
('3003', 'Eta Solutions', 'San Antonio', '2', '5004'),
('3006', 'Theta Services', 'San Diego', '3', '5005');

CREATE TABLE IF NOT EXISTS ORDERS(
    ORDER_NO TEXT PRIMARY KEY,
    PURCHASE_DATE TEXT,
    CUST_ID TEXT,
    SALESMAN_ID TEXT,
    ORDER_DATE TEXT,
    PURCH_AMT TEXT
);

INSERT INTO ORDERS (ORDER_NO, PURCHASE_DATE, CUST_ID, SALESMAN_ID, ORDER_DATE,PURCH_AMT) VALUES
('70001', '2023-01-15', '3002', '5001', '2023-01-10','123'),
('70002', '2023-02-20', '3007', '5001', '2023-02-15','300'),
('70003', '2023-03-25', '3005', '5002', '2023-03-20','670'),
('70004', '2023-04-30', '3008', '5002', '2023-04-25','2400'),
('70005', '2023-05-05', '3001', '5006', '2023-05-01','1500'),
('70006', '2023-06-10', '3004', '5003', '2023-06-05','560');

SELECT CUSTOMER.CUST_NAME, SALESMAN.NAME,SALESMAN.CITY
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.CITY = SALESMAN.CITY;

SELECT CUSTOMER.CUST_NAME, SALESMAN.NAME
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.SALESMAN_ID = SALESMAN.SALESMAN_ID;

SELECT ORDERS.ORDER_NO, CUSTOMER.CUST_NAME,ORDERS.CUST_ID,ORDERS.SALESMAN_ID
FROM ORDERS
JOIN CUSTOMER ON ORDERS.CUST_ID = CUSTOMER.CUST_ID
JOIN SALESMAN ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE CUSTOMER.CITY <> SALESMAN.CITY;

SELECT ORDERS.ORDER_NO, CUSTOMER.CUST_NAME
FROM ORDERS
JOIN CUSTOMER ON ORDERS.CUST_ID=CUSTOMER.CUST_ID;

SELECT CUSTOMER.CUST_NAME AS "CUSTOMER",CUSTOMER.GRADE AS "GRADE"
FROM ORDERS
JOIN SALESMAN ON ORDERS.SALESMAN_ID=SALESMAN.SALESMAN_ID
JOIN CUSTOMER ON ORDERS.CUST_ID=CUSTOMER.CUST_ID    
WHERE CUSTOMER.GRADE IS NOT NULL;

SELECT CUSTOMER.CUST_NAME AS "CUSTOMER",CUSTOMER.CITY AS "CITY",SALESMAN.NAME AS "SALESMAN",SALESMAN.COMMISION
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.SALESMAN_ID=SALESMAN.SALESMAN_ID
WHERE SALESMAN.COMMISION BETWEEN '0.12' AND '0.14';

SELECT ORDERS.ORDER_NO,CUSTOMER.CUST_NAME,SALESMAN.COMMISION AS "COMMISION%",ORDERS.PURCH_AMT*SALESMAN.COMMISION AS "COMMISION"
FROM ORDERS
JOIN SALESMAN ON ORDERS.SALESMAN_ID=SALESMAN.SALESMAN_ID
JOIN CUSTOMER ON ORDERS.CUST_ID=CUSTOMER.CUST_ID
WHERE CUSTOMER.GRADE>='200'; 

DROP TABLE IF EXISTS ORDERS;

SELECT * 
FROM CUSTOMER
JOIN ORDERS ON CUSTOMER.CUST_ID = ORDERS.CUST_ID
WHERE ORDERS.ORDER_DATE > '2023-03-01';